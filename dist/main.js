(()=>{"use strict";var t=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.dotRaw=function(t,e,n,i){return t*n+e*i},t.dot=function(t,e){return this.dotRaw(t.x,t.y,e.x,e.y)},t.prototype.dot=function(e){return t.dot(this,e)},t.crossRaw=function(t,e,n,i){return t*i-n*e},t.cross=function(t,e){return this.crossRaw(t.x,t.y,e.x,e.y)},t.prototype.cross=function(e){return t.cross(this,e)},t.lenRaw=function(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))},t.len=function(t){return this.lenRaw(t.x,t.y)},t.prototype.len=function(){return t.len(this)},t.normalizeRaw=function(t,e,n){void 0===n&&(n=1);var i=n/this.lenRaw(t,e);return this.mulRaw(t,e,i)},t.normalize=function(t,e){return void 0===e&&(e=1),this.normalizeRaw(t.x,t.y,e)},t.prototype.normalize=function(e){return void 0===e&&(e=1),t.normalize(this,e)},t.equalsRaw=function(t,e,n,i){return t===n&&e===i},t.equals=function(t,e){return this.equalsRaw(t.x,t.y,e.x,e.y)},t.prototype.equals=function(e){return t.equals(this,e)},t.addRaw=function(e,n,i,r){return new t(e+i,n+r)},t.add=function(t,e){return this.addRaw(t.x,t.y,e.x,e.y)},t.prototype.add=function(e){return t.add(this,e)},t.subRaw=function(e,n,i,r){return new t(e-i,n-r)},t.sub=function(t,e){return this.subRaw(t.x,t.y,e.x,e.y)},t.prototype.sub=function(e){return t.sub(this,e)},t.mulRaw=function(e,n,i){return new t(e*i,n*i)},t.mul=function(t,e){return this.mulRaw(t.x,t.y,e)},t.prototype.mul=function(e){return t.mul(this,e)},t.intersectionTimesRaw=function(e,n,i,r,s,o,u,h){var c=this.crossRaw(i-e,r-n,u-s,h-o);return new t(this.crossRaw(u-s,h-o,e-s,n-o)/c,this.crossRaw(i-e,r-n,e-s,n-o)/c)},t.intersectionTimes=function(t,e,n,i){return this.intersectionTimesRaw(t.x,t.y,e.x,e.y,n.x,n.y,i.x,i.y)},t.prototype.intersectionTimes=function(e,n,i){return t.intersectionTimes(this,e,n,i)},t.intersectionRaw=function(t,e,n,i,r,s,o,u){var h=this.intersectionTimesRaw(t,e,n,i,r,s,o,u);if(h)return h.y=e+(i-e)*h.x,h.x=t+(n-t)*h.x,h},t.intersection=function(t,e,n,i){return this.intersectionRaw(t.x,t.y,e.x,e.y,n.x,n.y,i.x,i.y)},t.prototype.intersection=function(e,n,i){return t.intersection(this,e,n,i)},t.prototype.angle=function(t){if(t){var e=this.angle(),n=t.angle();return n<e?n+2*Math.PI-e:n-e}return this.y>0?Math.acos(this.x/this.len()):2*Math.PI-Math.acos(this.x/this.len())},t}(),e=function(){function e(e,n,i,r){this.v1=new t(e,n),this.v2=new t(i,r)}return Object.defineProperty(e.prototype,"x1",{get:function(){return this.v1.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this.v1.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this.v2.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this.v2.y},enumerable:!1,configurable:!0}),e.prototype.len=function(){return this.v2.sub(this.v1).len()},e.prototype.before=function(t){return this.v1.add(this.v2.sub(this.v1).mul(-t/this.len()))},e.prototype.after=function(t){return this.v1.add(this.v2.sub(this.v1).mul((this.len()+t)/this.len()))},e.prototype.intersectionTimesWith=function(t){return this.v1.intersectionTimes(this.v2,t.v1,t.v2)},e.prototype.update=function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.v1.x+=t,this.v1.y+=e,this.v2.x+=n,this.v2.y+=i},e}(),n=function(){function t(t){var n,i,r,s,o=this;this.renderer=t,this.lines=[],this.intersectionTimes=[],this.intersectionPoints=[],this.renderer.setMouseDownHandler((function(t,r,s){i=s||null,(n=r||null)||(n=new e(t.clientX,t.clientY,t.clientX,t.clientY),i=n.v2,o.addLine(n))})),this.renderer.setMouseUpHandler((function(t,e,u){e?(r&&r!==e&&o.renderer.drawLine(r,e===s,!1),r=e,o.renderer.drawLine(r,e===s,!0)):r&&o.renderer.drawLine(r,e===s,!1),n=null,i=null})),this.renderer.setMouseMoveHandler((function(t,e,u){e?(s&&s!==e&&o.renderer.drawLine(s,!1,e===r),s=e,o.renderer.drawLine(s,!0,e===r)):s&&(o.renderer.drawLine(s,!1,e===r),s=null),n&&(i?(i.x=t.clientX,i.y=t.clientY):n.update(t.movementX,t.movementY,t.movementX,t.movementY),o.updateIntersectionTimes(n),o.renderer.drawLine(n,n===s,n===r))}))}return t.prototype.addLine=function(t){this.addIntersectionTimes(t),this.lines.push(t),this.renderer.drawLine(t,!1,!1)},t.prototype.addIntersectionTimes=function(t){for(var e,n=[],i=[],r=0;r<this.lines.length;r++)e=this.lines[r].intersectionTimesWith(t),this.intersectionTimes[r].push(e.x),this.intersectionPoints[r].push(0<=e.x&&e.x<=1&&0<=e.y&&e.y<=1?this.lines[r].v1.add(this.lines[r].v2.sub(this.lines[r].v1).mul(e.x)):null),n.push(e.y),i.push(null);n.push(NaN),i.push(null),this.intersectionTimes.push(n),this.intersectionPoints.push(i),this.renderIntersections()},t.prototype.updateIntersectionTimes=function(t){for(var e,n=this.lines.indexOf(t),i=0;i<this.lines.length;i++)i!==n&&(e=this.lines[i].intersectionTimesWith(t),this.intersectionTimes[i][n]=e.x,this.intersectionTimes[n][i]=e.y,i<n?this.intersectionPoints[i][n]=0<=e.x&&e.x<=1&&0<=e.y&&e.y<=1?this.lines[i].v1.add(this.lines[i].v2.sub(this.lines[i].v1).mul(e.x)):null:this.intersectionPoints[n][i]=0<=e.x&&e.x<=1&&0<=e.y&&e.y<=1?this.lines[i].v1.add(this.lines[i].v2.sub(this.lines[i].v1).mul(e.x)):null);this.renderIntersections()},t.prototype.renderIntersections=function(){var t=this;this.renderer.clearIntersections(),this.intersectionPoints.forEach((function(e){e.forEach((function(e){e&&t.renderer.drawPoint(e)}))}))},t}(),i=document.createElementNS("http://www.w3.org/2000/svg","g");i.setAttribute("stroke","black"),i.setAttribute("stroke-width","0.4px");var r=document.createElementNS("http://www.w3.org/2000/svg","line");r.setAttribute("stroke-dasharray","10, 4, 1, 4");var s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d","M 0, 0A 10, 10, 0, 0, 0, -5, -5A 10, 10, 0, 1, 1, 5, -5A 10, 10, 0, 0, 0, 0, 0"),s.setAttribute("fill","white"),i.appendChild(r),i.appendChild(s),i.appendChild(s.cloneNode());var o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.setAttribute("fill","green"),o.setAttribute("r","3");var u=new(function(){function t(){this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.intersectionContainer=document.createElementNS("http://www.w3.org/2000/svg","g"),this.svgGByLine=new Map,this.lineBySvgG=new Map,this.svg.appendChild(this.intersectionContainer)}return t.prototype.clickHandlerWrapper=function(t){var e=this;return function(n){var i=document.elementFromPoint(n.clientX,n.clientY),r=e.lineBySvgG.get(i.parentNode);i instanceof SVGPathElement?i.parentNode.children[1]===i?t(n,r,r.v1):t(n,r,r.v2):i instanceof SVGLineElement?t(n,r):t(n)}},t.prototype.setMouseDownHandler=function(t){this.onMouseDown&&this.svg.removeEventListener("mousedown",this.onMouseDown),this.onMouseDown=this.clickHandlerWrapper(t),this.svg.addEventListener("mousedown",this.onMouseDown)},t.prototype.setMouseUpHandler=function(t){this.onMouseUp&&this.svg.removeEventListener("mouseup",this.onMouseUp),this.onMouseUp=this.clickHandlerWrapper(t),this.svg.addEventListener("mouseup",this.onMouseUp)},t.prototype.setMouseMoveHandler=function(t){this.onMouseMove&&this.svg.removeEventListener("mousemove",this.onMouseMove),this.onMouseMove=this.clickHandlerWrapper(t),this.svg.addEventListener("mousemove",this.onMouseMove)},t.prototype.drawLine=function(t,e,n){var r;void 0===e&&(e=!1),void 0===n&&(n=!1),this.svgGByLine.has(t)?r=this.svgGByLine.get(t):(r=i.cloneNode(!0),this.svg.appendChild(r),this.svgGByLine.set(t,r),this.lineBySvgG.set(r,t));var s=r.children[0],o=r.children[1],u=r.children[2],h=t.x1.toFixed(),c=t.y1.toFixed(),a=t.x2.toFixed(),l=t.y2.toFixed();s.setAttribute("x1",h),s.setAttribute("y1",c),s.setAttribute("x2",a),s.setAttribute("y2",l),e?r.setAttribute("stroke-width","0.8px"):r.setAttribute("stroke-width","0.4px"),n?r.setAttribute("stroke","#19a194"):r.setAttribute("stroke","black");var d=180*(t.v2.sub(t.v1).angle()-Math.PI/2)/Math.PI;o.setAttribute("transform","translate("+h+", "+c+") rotate("+(isNaN(d)?0:d)+")"),u.setAttribute("transform","translate("+a+", "+l+") rotate("+(isNaN(d)?0:180+d)+")")},t.prototype.eraseLine=function(t){var e=this.svgGByLine.get(t);e&&(this.svg.removeChild(e),this.svgGByLine.delete(t))},t.prototype.drawPoint=function(t){var e=o.cloneNode();e.setAttribute("cx",t.x.toFixed()),e.setAttribute("cy",t.y.toFixed()),this.intersectionContainer.appendChild(e)},t.prototype.clearIntersections=function(){var t=this;this.intersectionContainer.childNodes.forEach((function(e){return t.intersectionContainer.removeChild(e)}))},t}());new n(u),document.querySelector("body").appendChild(u.svg)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wb2xwbG90Ly4vc3JjL3ZlY3RvcjIudHMiLCJ3ZWJwYWNrOi8vcG9scGxvdC8uL3NyYy9saW5lLnRzIiwid2VicGFjazovL3BvbHBsb3QvLi9zcmMvcG9scGxvdC50cyIsIndlYnBhY2s6Ly9wb2xwbG90Ly4vc3JjL3N2Zy1yZW5kZXJlci50cyIsIndlYnBhY2s6Ly9wb2xwbG90Ly4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbIngiLCJ5IiwiZG90UmF3IiwieDEiLCJ5MSIsIngyIiwieTIiLCJkb3QiLCJ1IiwidiIsInRoaXMiLCJvdGhlciIsIlZlY3RvcjIiLCJjcm9zc1JhdyIsImNyb3NzIiwibGVuUmF3IiwiTWF0aCIsInNxcnQiLCJwb3ciLCJsZW4iLCJub3JtYWxpemVSYXciLCJieSIsImNvZWYiLCJtdWxSYXciLCJub3JtYWxpemUiLCJlcXVhbHNSYXciLCJlcXVhbHMiLCJhZGRSYXciLCJhZGQiLCJzdWJSYXciLCJzdWIiLCJtdWwiLCJpbnRlcnNlY3Rpb25UaW1lc1JhdyIsImZ4IiwiZnkiLCJ0eCIsInR5Iiwic3giLCJzeSIsImV4IiwiZXkiLCJkZXQiLCJpbnRlcnNlY3Rpb25UaW1lcyIsImZyb20iLCJ0byIsInN0YXJ0IiwiZW5kIiwiaW50ZXJzZWN0aW9uUmF3IiwidGltZXMiLCJpbnRlcnNlY3Rpb24iLCJhbmdsZSIsImExIiwiYTIiLCJQSSIsImFjb3MiLCJ2MSIsInYyIiwiYmVmb3JlIiwidCIsImFmdGVyIiwiaW50ZXJzZWN0aW9uVGltZXNXaXRoIiwidXBkYXRlIiwiZHgxIiwiZHkxIiwiZHgyIiwiZHkyIiwicmVuZGVyZXIiLCJkcmFnZ2VkTGluZSIsImRyYWdnZWRWZWN0b3IyIiwic2VsZWN0ZWRMaW5lIiwiaG92ZXJlZExpbmUiLCJsaW5lcyIsImludGVyc2VjdGlvblBvaW50cyIsInNldE1vdXNlRG93bkhhbmRsZXIiLCJldmVudCIsImNsaWNrZWRMaW5lIiwiY2xpY2tlZFZlY3RvcjIiLCJMaW5lIiwiY2xpZW50WCIsImNsaWVudFkiLCJhZGRMaW5lIiwic2V0TW91c2VVcEhhbmRsZXIiLCJkcmF3TGluZSIsInNldE1vdXNlTW92ZUhhbmRsZXIiLCJtb3ZlbWVudFgiLCJtb3ZlbWVudFkiLCJ1cGRhdGVJbnRlcnNlY3Rpb25UaW1lcyIsImxpbmUiLCJhZGRJbnRlcnNlY3Rpb25UaW1lcyIsInB1c2giLCJpIiwibGVuZ3RoIiwiTmFOIiwicmVuZGVySW50ZXJzZWN0aW9ucyIsImluZGV4IiwiaW5kZXhPZiIsImNsZWFySW50ZXJzZWN0aW9ucyIsImZvckVhY2giLCJpbnRlcnNlY3Rpb25Qb2ludCIsImRyYXdQb2ludCIsImdUZW1wbGF0ZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudE5TIiwic2V0QXR0cmlidXRlIiwibGluZVRlbXBsYXRlIiwiYW5jaG9yVGVtcGxhdGUiLCJhcHBlbmRDaGlsZCIsImNsb25lTm9kZSIsInBvaW50VGVtcGxhdGUiLCJzdmdSZW5kZXJlciIsInN2ZyIsImludGVyc2VjdGlvbkNvbnRhaW5lciIsInN2Z0dCeUxpbmUiLCJNYXAiLCJsaW5lQnlTdmdHIiwiY2xpY2tIYW5kbGVyV3JhcHBlciIsImNsaWNrSGFuZGxlciIsImVsZW1lbnRBdCIsImVsZW1lbnRGcm9tUG9pbnQiLCJnZXQiLCJwYXJlbnROb2RlIiwiU1ZHUGF0aEVsZW1lbnQiLCJjaGlsZHJlbiIsIlNWR0xpbmVFbGVtZW50Iiwib25Nb3VzZURvd24iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uTW91c2VVcCIsIm9uTW91c2VNb3ZlIiwiaXNIb3ZlcmVkIiwiaXNTZWxlY3RlZCIsInN2Z0ciLCJoYXMiLCJzZXQiLCJzdmdMaW5lIiwic3ZnUGF0aEFuY2hvclN0YXJ0Iiwic3ZnUGF0aEFuY2hvckVuZCIsInRvRml4ZWQiLCJpc05hTiIsImVyYXNlTGluZSIsInJlbW92ZUNoaWxkIiwiZGVsZXRlIiwicG9pbnQiLCJzdmdDaXJjbGUiLCJjaGlsZE5vZGVzIiwiY2hpbGROb2RlIiwi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QVVsQyxLQUFLcUMsR0FBSyxHQUFLckMsS0FBS3FDLEdBQ3hFa0YsRUFBbUJoQyxhQUFhLFlBQWEsYUFBYXBHLEVBQUUsS0FBS0MsRUFBRSxhQUFZc0ksTUFBTXhGLEdBQVMsRUFBSUEsR0FBSyxLQUN2R3NGLEVBQWlCakMsYUFBYSxZQUFhLGFBQWFsRyxFQUFFLEtBQUtDLEVBQUUsYUFBWW9JLE1BQU14RixHQUFTLEVBQUksSUFBTUEsR0FBSyxNQUU3RyxZQUFBeUYsVUFBQSxTQUFVcEQsR0FDUixJQUFNNEMsRUFBT3pILEtBQUtzRyxXQUFXTyxJQUFJaEMsR0FDN0I0QyxJQUNGekgsS0FBS29HLElBQUk4QixZQUFZVCxHQUNyQnpILEtBQUtzRyxXQUFXNkIsT0FBT3RELEtBRzNCLFlBQUFZLFVBQUEsU0FBVTJDLEdBQ1IsSUFBTUMsRUFBWW5DLEVBQWNELFlBQ2hDb0MsRUFBVXhDLGFBQWEsS0FBTXVDLEVBQU05SSxFQUFFeUksV0FDckNNLEVBQVV4QyxhQUFhLEtBQU11QyxFQUFNN0ksRUFBRXdJLFdBQ3JDL0gsS0FBS3FHLHNCQUFzQkwsWUFBWXFDLElBRXpDLFlBQUEvQyxtQkFBQSxzQkFDRXRGLEtBQUtxRyxzQkFBc0JpQyxXQUFXL0MsU0FBUSxTQUFBZ0QsR0FBYSxTQUFLbEMsc0JBQXNCNkIsWUFBWUssT0FFdEcsRUFwR0EsSUN6QmdCLElBQUlDLEVBQVFyQyxHQUNmUixTQUFTOEMsY0FBYyxRQUMvQnpDLFlBQVlHLEVBQVlDLE0iLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBWZWN0b3IyIHtcbiAgY29uc3RydWN0b3IocHVibGljIHggPSAwLCBwdWJsaWMgeSA9IDApIHt9XG4gIHN0YXRpYyBkb3RSYXcoeDE6IG51bWJlciwgeTE6IG51bWJlciwgeDI6IG51bWJlciwgeTI6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHgxICogeDIgKyB5MSAqIHkyO1xuICB9XG4gIHN0YXRpYyBkb3QodTogVmVjdG9yMiwgdjogVmVjdG9yMik6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZG90UmF3KHUueCwgdS55LCB2LngsIHYueSk7XG4gIH1cbiAgZG90KG90aGVyOiBWZWN0b3IyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gVmVjdG9yMi5kb3QodGhpcywgb3RoZXIpO1xuICB9XG4gIHN0YXRpYyBjcm9zc1Jhdyh4MTogbnVtYmVyLCB5MTogbnVtYmVyLCB4MjogbnVtYmVyLCB5MjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4geDEgKiB5MiAtIHgyICogeTE7XG4gIH1cbiAgc3RhdGljIGNyb3NzKHU6IFZlY3RvcjIsIHY6IFZlY3RvcjIpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmNyb3NzUmF3KHUueCwgdS55LCB2LngsIHYueSk7XG4gIH1cbiAgY3Jvc3Mob3RoZXI6IFZlY3RvcjIpOiBudW1iZXIge1xuICAgIHJldHVybiBWZWN0b3IyLmNyb3NzKHRoaXMsIG90aGVyKTtcbiAgfVxuICBzdGF0aWMgbGVuUmF3KHg6IG51bWJlciwgeTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KHgsIDIpICsgTWF0aC5wb3coeSwgMikpO1xuICB9XG4gIHN0YXRpYyBsZW4odTogVmVjdG9yMik6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubGVuUmF3KHUueCwgdS55KTtcbiAgfVxuICBsZW4oKTogbnVtYmVyIHtcbiAgICByZXR1cm4gVmVjdG9yMi5sZW4odGhpcyk7XG4gIH1cbiAgc3RhdGljIG5vcm1hbGl6ZVJhdyh4OiBudW1iZXIsIHk6IG51bWJlciwgYnk6IG51bWJlciA9IDEpOiBWZWN0b3IyIHtcbiAgICBjb25zdCBjb2VmID0gYnkgLyB0aGlzLmxlblJhdyh4LCB5KTtcbiAgICByZXR1cm4gdGhpcy5tdWxSYXcoeCwgeSwgY29lZik7XG4gIH1cbiAgc3RhdGljIG5vcm1hbGl6ZSh1OiBWZWN0b3IyLCBieTogbnVtYmVyID0gMSk6IFZlY3RvcjIge1xuICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZVJhdyh1LngsIHUueSwgYnkpO1xuICB9XG4gIG5vcm1hbGl6ZShieTogbnVtYmVyID0gMSk6IFZlY3RvcjIge1xuICAgIHJldHVybiBWZWN0b3IyLm5vcm1hbGl6ZSh0aGlzLCBieSk7XG4gIH1cbiAgc3RhdGljIGVxdWFsc1Jhdyh4MTogbnVtYmVyLCB5MTogbnVtYmVyLCB4MjogbnVtYmVyLCB5MjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHgxID09PSB4MiAmJiB5MSA9PT0geTI7XG4gIH1cbiAgc3RhdGljIGVxdWFscyh1OiBWZWN0b3IyLCB2OiBWZWN0b3IyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZXF1YWxzUmF3KHUueCwgdS55LCB2LngsIHYueSk7XG4gIH1cbiAgZXF1YWxzKG90aGVyOiBWZWN0b3IyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIFZlY3RvcjIuZXF1YWxzKHRoaXMsIG90aGVyKTtcbiAgfVxuICBzdGF0aWMgYWRkUmF3KHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHgyOiBudW1iZXIsIHkyOiBudW1iZXIpOiBWZWN0b3IyIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIoeDEgKyB4MiwgeTEgKyB5Mik7XG4gIH1cbiAgc3RhdGljIGFkZCh1OiBWZWN0b3IyLCB2OiBWZWN0b3IyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkUmF3KHUueCwgdS55LCB2LngsIHYueSk7XG4gIH1cbiAgYWRkKG90aGVyOiBWZWN0b3IyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIFZlY3RvcjIuYWRkKHRoaXMsIG90aGVyKTtcbiAgfVxuICBzdGF0aWMgc3ViUmF3KHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHgyOiBudW1iZXIsIHkyOiBudW1iZXIpOiBWZWN0b3IyIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIoeDEgLSB4MiwgeTEgLSB5Mik7XG4gIH1cbiAgc3RhdGljIHN1Yih1OiBWZWN0b3IyLCB2OiBWZWN0b3IyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMuc3ViUmF3KHUueCwgdS55LCB2LngsIHYueSk7XG4gIH1cbiAgc3ViKG90aGVyOiBWZWN0b3IyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIFZlY3RvcjIuc3ViKHRoaXMsIG90aGVyKTtcbiAgfVxuICBzdGF0aWMgbXVsUmF3KHg6IG51bWJlciwgeTogbnVtYmVyLCBieTogbnVtYmVyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKHggKiBieSwgeSAqIGJ5KTtcbiAgfVxuICBzdGF0aWMgbXVsKHU6IFZlY3RvcjIsIGJ5OiBudW1iZXIpOiBWZWN0b3IyIHtcbiAgICByZXR1cm4gdGhpcy5tdWxSYXcodS54LCB1LnksIGJ5KTtcbiAgfVxuICBtdWwoYnk6IG51bWJlcik6IFZlY3RvcjIge1xuICAgIHJldHVybiBWZWN0b3IyLm11bCh0aGlzLCBieSk7XG4gIH1cbiAgc3RhdGljIGludGVyc2VjdGlvblRpbWVzUmF3KFxuICAgIGZ4OiBudW1iZXIsIGZ5OiBudW1iZXIsIHR4OiBudW1iZXIsIHR5OiBudW1iZXIsXG4gICAgc3g6IG51bWJlciwgc3k6IG51bWJlciwgZXg6IG51bWJlciwgZXk6IG51bWJlclxuICApOiBWZWN0b3IyIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBkZXQgPSB0aGlzLmNyb3NzUmF3KHR4IC0gZngsIHR5IC0gZnksIGV4IC0gc3gsIGV5IC0gc3kpO1xuICAgIHJldHVybiBuZXcgVmVjdG9yMihcbiAgICAgIHRoaXMuY3Jvc3NSYXcoZXggLSBzeCwgZXkgLSBzeSwgZnggLSBzeCwgZnkgLSBzeSkgLyBkZXQsXG4gICAgICB0aGlzLmNyb3NzUmF3KHR4IC0gZngsIHR5IC0gZnksIGZ4IC0gc3gsIGZ5IC0gc3kpIC8gZGV0XG4gICAgKTtcbiAgfVxuICBzdGF0aWMgaW50ZXJzZWN0aW9uVGltZXMoXG4gICAgZnJvbTogVmVjdG9yMiwgdG86IFZlY3RvcjIsIHN0YXJ0OiBWZWN0b3IyLCBlbmQ6IFZlY3RvcjJcbiAgKTogVmVjdG9yMiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuaW50ZXJzZWN0aW9uVGltZXNSYXcoZnJvbS54LCBmcm9tLnksIHRvLngsIHRvLnksIHN0YXJ0LngsIHN0YXJ0LnksIGVuZC54LCBlbmQueSk7XG4gIH1cbiAgaW50ZXJzZWN0aW9uVGltZXModG86IFZlY3RvcjIsIHN0YXJ0OiBWZWN0b3IyLCBlbmQ6IFZlY3RvcjIpOiBWZWN0b3IyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gVmVjdG9yMi5pbnRlcnNlY3Rpb25UaW1lcyh0aGlzLCB0bywgc3RhcnQsIGVuZCk7XG4gIH1cbiAgc3RhdGljIGludGVyc2VjdGlvblJhdyhcbiAgICBmeDogbnVtYmVyLCBmeTogbnVtYmVyLCB0eDogbnVtYmVyLCB0eTogbnVtYmVyLFxuICAgIHN4OiBudW1iZXIsIHN5OiBudW1iZXIsIGV4OiBudW1iZXIsIGV5OiBudW1iZXJcbiAgKTogVmVjdG9yMiB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgdGltZXMgPSB0aGlzLmludGVyc2VjdGlvblRpbWVzUmF3KGZ4LCBmeSwgdHgsIHR5LCBzeCwgc3ksIGV4LCBleSk7XG4gICAgaWYgKHRpbWVzKSB7XG4gICAgICB0aW1lcy55ID0gZnkgKyAodHkgLSBmeSkgKiB0aW1lcy54O1xuICAgICAgdGltZXMueCA9IGZ4ICsgKHR4IC0gZngpICogdGltZXMueDtcbiAgICAgIHJldHVybiB0aW1lcztcbiAgICB9XG4gIH1cbiAgc3RhdGljIGludGVyc2VjdGlvbihmcm9tOiBWZWN0b3IyLCB0bzogVmVjdG9yMiwgc3RhcnQ6IFZlY3RvcjIsIGVuZDogVmVjdG9yMik6IFZlY3RvcjIgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmludGVyc2VjdGlvblJhdyhmcm9tLngsIGZyb20ueSwgdG8ueCwgdG8ueSwgc3RhcnQueCwgc3RhcnQueSwgZW5kLngsIGVuZC55KTtcbiAgfVxuICBpbnRlcnNlY3Rpb24odG86IFZlY3RvcjIsIHN0YXJ0OiBWZWN0b3IyLCBlbmQ6IFZlY3RvcjIpOiBWZWN0b3IyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gVmVjdG9yMi5pbnRlcnNlY3Rpb24odGhpcywgdG8sIHN0YXJ0LCBlbmQpO1xuICB9XG4gIGFuZ2xlKG90aGVyPzogVmVjdG9yMik6IG51bWJlciB7XG4gICAgaWYgKG90aGVyKSB7XG4gICAgICAgY29uc3QgYTEgPSB0aGlzLmFuZ2xlKCk7XG4gICAgICAgY29uc3QgYTIgPSBvdGhlci5hbmdsZSgpO1xuICAgICAgIGlmIChhMiA8IGExKSB7XG4gICAgICAgIHJldHVybiBhMiArIDIgKiBNYXRoLlBJIC0gYTE7XG4gICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGEyIC0gYTE7XG4gICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy55ID4gMCkge1xuICAgICAgcmV0dXJuIE1hdGguYWNvcyh0aGlzLnggLyB0aGlzLmxlbigpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIDIgKiBNYXRoLlBJIC0gTWF0aC5hY29zKHRoaXMueCAvIHRoaXMubGVuKCkpO1xuICAgIH1cbiAgfVxufSIsImltcG9ydCB7IFZlY3RvcjIgfSBmcm9tIFwiLi92ZWN0b3IyXCI7XG5cbmV4cG9ydCBjbGFzcyBMaW5lIHtcbiAgdjE6IFZlY3RvcjI7XG4gIHYyOiBWZWN0b3IyO1xuICBjb25zdHJ1Y3RvcihcbiAgICB4MT86IG51bWJlcixcbiAgICB5MT86IG51bWJlcixcbiAgICB4Mj86IG51bWJlcixcbiAgICB5Mj86IG51bWJlclxuICApIHtcbiAgICB0aGlzLnYxID0gbmV3IFZlY3RvcjIoeDEsIHkxKTtcbiAgICB0aGlzLnYyID0gbmV3IFZlY3RvcjIoeDIsIHkyKTtcbiAgfVxuICBnZXQgeDEoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy52MS54O1xuICB9XG4gIGdldCB5MSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnYxLnk7XG4gIH1cbiAgZ2V0IHgyKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMudjIueDtcbiAgfVxuICBnZXQgeTIoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy52Mi55O1xuICB9XG4gIGxlbigpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnYyLnN1Yih0aGlzLnYxKS5sZW4oKTtcbiAgfVxuICBiZWZvcmUodDogbnVtYmVyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMudjEuYWRkKHRoaXMudjIuc3ViKHRoaXMudjEpLm11bCgtdCAvIHRoaXMubGVuKCkpKTtcbiAgfVxuICBhZnRlcih0OiBudW1iZXIpOiBWZWN0b3IyIHtcbiAgICByZXR1cm4gdGhpcy52MS5hZGQodGhpcy52Mi5zdWIodGhpcy52MSkubXVsKCh0aGlzLmxlbigpICsgdCkgLyB0aGlzLmxlbigpKSk7XG4gIH1cbiAgaW50ZXJzZWN0aW9uVGltZXNXaXRoKG90aGVyOiBMaW5lKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMudjEuaW50ZXJzZWN0aW9uVGltZXModGhpcy52Miwgb3RoZXIudjEsIG90aGVyLnYyKTtcbiAgfVxuICB1cGRhdGUoZHgxID0gMCwgZHkxID0gMCwgZHgyID0gMCwgZHkyID0gMCk6IHZvaWQge1xuICAgIHRoaXMudjEueCArPSBkeDE7XG4gICAgdGhpcy52MS55ICs9IGR5MTtcbiAgICB0aGlzLnYyLnggKz0gZHgyO1xuICAgIHRoaXMudjIueSArPSBkeTI7XG4gIH1cbn0iLCJpbXBvcnQgeyBQb2xwbG90UmVuZGVyZXIgfSBmcm9tIFwiLi9pbnRlcmZhY2VzL3BvbHBsb3QtcmVuZGVyZXJcIjtcbmltcG9ydCB7IExpbmUgfSBmcm9tIFwiLi9saW5lXCI7XG5pbXBvcnQgeyBWZWN0b3IyIH0gZnJvbSBcIi4vdmVjdG9yMlwiO1xuXG5leHBvcnQgY2xhc3MgUG9sUGxvdCB7XG4gIGxpbmVzOiBMaW5lW10gPSBbXTtcbiAgaW50ZXJzZWN0aW9uVGltZXM6IG51bWJlcltdW10gPSBbXTtcbiAgaW50ZXJzZWN0aW9uUG9pbnRzOiBWZWN0b3IyW11bXSA9IFtdO1xuICBjb25zdHJ1Y3RvcihyZWFkb25seSByZW5kZXJlcjogUG9scGxvdFJlbmRlcmVyKSB7XG4gICAgbGV0IGRyYWdnZWRMaW5lOiBMaW5lO1xuICAgIGxldCBkcmFnZ2VkVmVjdG9yMjogVmVjdG9yMjtcblxuICAgIHRoaXMucmVuZGVyZXIuc2V0TW91c2VEb3duSGFuZGxlcigoZXZlbnQsIGNsaWNrZWRMaW5lLCBjbGlja2VkVmVjdG9yMikgPT4ge1xuICAgICAgZHJhZ2dlZExpbmUgPSBjbGlja2VkTGluZSB8fCBudWxsO1xuICAgICAgZHJhZ2dlZFZlY3RvcjIgPSBjbGlja2VkVmVjdG9yMiB8fCBudWxsO1xuICAgICAgaWYgKCFkcmFnZ2VkTGluZSkge1xuICAgICAgICBkcmFnZ2VkTGluZSA9IG5ldyBMaW5lKGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFksIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkpO1xuICAgICAgICBkcmFnZ2VkVmVjdG9yMiA9IGRyYWdnZWRMaW5lLnYyO1xuICAgICAgICB0aGlzLmFkZExpbmUoZHJhZ2dlZExpbmUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbGV0IHNlbGVjdGVkTGluZTogTGluZTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldE1vdXNlVXBIYW5kbGVyKChldmVudCwgY2xpY2tlZExpbmUsIGNsaWNrZWRWZWN0b3IyKSA9PiB7XG4gICAgICBpZiAoY2xpY2tlZExpbmUpIHtcbiAgICAgICAgaWYgKHNlbGVjdGVkTGluZSAmJiBzZWxlY3RlZExpbmUgIT09IGNsaWNrZWRMaW5lKSB7XG4gICAgICAgICAgdGhpcy5yZW5kZXJlci5kcmF3TGluZShzZWxlY3RlZExpbmUsIGNsaWNrZWRMaW5lID09PSBob3ZlcmVkTGluZSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGVjdGVkTGluZSA9IGNsaWNrZWRMaW5lO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmRyYXdMaW5lKHNlbGVjdGVkTGluZSwgY2xpY2tlZExpbmUgPT09IGhvdmVyZWRMaW5lLCB0cnVlKTtcbiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRMaW5lKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuZHJhd0xpbmUoc2VsZWN0ZWRMaW5lLCBjbGlja2VkTGluZSA9PT0gaG92ZXJlZExpbmUsIGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIGRyYWdnZWRMaW5lID0gbnVsbDtcbiAgICAgIGRyYWdnZWRWZWN0b3IyID0gbnVsbDtcbiAgICB9KTtcblxuICAgIGxldCBob3ZlcmVkTGluZTogTGluZTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldE1vdXNlTW92ZUhhbmRsZXIoKGV2ZW50LCBjbGlja2VkTGluZSwgY2xpY2tlZFZlY3RvcjIpID0+IHtcbiAgICAgIGlmIChjbGlja2VkTGluZSkge1xuICAgICAgICBpZiAoaG92ZXJlZExpbmUgJiYgaG92ZXJlZExpbmUgIT09IGNsaWNrZWRMaW5lKSB7XG4gICAgICAgICAgdGhpcy5yZW5kZXJlci5kcmF3TGluZShob3ZlcmVkTGluZSwgZmFsc2UsIGNsaWNrZWRMaW5lID09PSBzZWxlY3RlZExpbmUpO1xuICAgICAgICB9XG4gICAgICAgIGhvdmVyZWRMaW5lID0gY2xpY2tlZExpbmU7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuZHJhd0xpbmUoaG92ZXJlZExpbmUsIHRydWUsIGNsaWNrZWRMaW5lID09PSBzZWxlY3RlZExpbmUpOyBcbiAgICAgIH0gZWxzZSBpZiAoaG92ZXJlZExpbmUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5kcmF3TGluZShob3ZlcmVkTGluZSwgZmFsc2UsIGNsaWNrZWRMaW5lID09PSBzZWxlY3RlZExpbmUpO1xuICAgICAgICBob3ZlcmVkTGluZSA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAoZHJhZ2dlZExpbmUpIHtcbiAgICAgICAgaWYgKGRyYWdnZWRWZWN0b3IyKSB7XG4gICAgICAgICAgZHJhZ2dlZFZlY3RvcjIueCA9IGV2ZW50LmNsaWVudFg7XG4gICAgICAgICAgZHJhZ2dlZFZlY3RvcjIueSA9IGV2ZW50LmNsaWVudFk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZHJhZ2dlZExpbmUudXBkYXRlKGV2ZW50Lm1vdmVtZW50WCwgZXZlbnQubW92ZW1lbnRZLCBldmVudC5tb3ZlbWVudFgsIGV2ZW50Lm1vdmVtZW50WSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVJbnRlcnNlY3Rpb25UaW1lcyhkcmFnZ2VkTGluZSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuZHJhd0xpbmUoZHJhZ2dlZExpbmUsIGRyYWdnZWRMaW5lID09PSBob3ZlcmVkTGluZSwgZHJhZ2dlZExpbmUgPT09IHNlbGVjdGVkTGluZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgYWRkTGluZShsaW5lOiBMaW5lKTogdm9pZCB7XG4gICAgdGhpcy5hZGRJbnRlcnNlY3Rpb25UaW1lcyhsaW5lKTtcbiAgICB0aGlzLmxpbmVzLnB1c2gobGluZSk7XG4gICAgdGhpcy5yZW5kZXJlci5kcmF3TGluZShsaW5lLCBmYWxzZSwgZmFsc2UpO1xuICB9XG4gIGFkZEludGVyc2VjdGlvblRpbWVzKGxpbmU6IExpbmUpOiB2b2lkIHtcbiAgICBjb25zdCBpbnRlcnNlY3Rpb25UaW1lczogbnVtYmVyW10gPSBbXTtcbiAgICBjb25zdCBpbnRlcnNlY3Rpb25Qb2ludHM6IFZlY3RvcjJbXSA9IFtdO1xuICAgIGxldCB0aW1lczogVmVjdG9yMjtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRpbWVzID0gdGhpcy5saW5lc1tpXS5pbnRlcnNlY3Rpb25UaW1lc1dpdGgobGluZSk7XG4gICAgICB0aGlzLmludGVyc2VjdGlvblRpbWVzW2ldLnB1c2godGltZXMueCk7XG4gICAgICB0aGlzLmludGVyc2VjdGlvblBvaW50c1tpXS5wdXNoKFxuICAgICAgICAwIDw9IHRpbWVzLnggJiYgdGltZXMueCA8PSAxICYmIDAgPD0gdGltZXMueSAmJiB0aW1lcy55IDw9IDFcbiAgICAgICAgICA/IHRoaXMubGluZXNbaV0udjEuYWRkKHRoaXMubGluZXNbaV0udjIuc3ViKHRoaXMubGluZXNbaV0udjEpLm11bCh0aW1lcy54KSlcbiAgICAgICAgICA6IG51bGxcbiAgICAgICk7XG4gICAgICBpbnRlcnNlY3Rpb25UaW1lcy5wdXNoKHRpbWVzLnkpO1xuICAgICAgaW50ZXJzZWN0aW9uUG9pbnRzLnB1c2gobnVsbCk7XG4gICAgfVxuICAgIGludGVyc2VjdGlvblRpbWVzLnB1c2goTmFOKTtcbiAgICBpbnRlcnNlY3Rpb25Qb2ludHMucHVzaChudWxsKTtcbiAgICB0aGlzLmludGVyc2VjdGlvblRpbWVzLnB1c2goaW50ZXJzZWN0aW9uVGltZXMpO1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uUG9pbnRzLnB1c2goaW50ZXJzZWN0aW9uUG9pbnRzKTtcbiAgICB0aGlzLnJlbmRlckludGVyc2VjdGlvbnMoKTtcbiAgfVxuICB1cGRhdGVJbnRlcnNlY3Rpb25UaW1lcyhsaW5lOiBMaW5lKTogdm9pZCB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmxpbmVzLmluZGV4T2YobGluZSk7XG4gICAgbGV0IHRpbWVzOiBWZWN0b3IyO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5saW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGkgIT09IGluZGV4KSB7XG4gICAgICAgIHRpbWVzID0gdGhpcy5saW5lc1tpXS5pbnRlcnNlY3Rpb25UaW1lc1dpdGgobGluZSk7XG4gICAgICAgIHRoaXMuaW50ZXJzZWN0aW9uVGltZXNbaV1baW5kZXhdID0gdGltZXMueDtcbiAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UaW1lc1tpbmRleF1baV0gPSB0aW1lcy55O1xuICAgICAgICBpZiAoaSA8IGluZGV4KSB7XG4gICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25Qb2ludHNbaV1baW5kZXhdID0gMCA8PSB0aW1lcy54ICYmIHRpbWVzLnggPD0gMSAmJiAwIDw9IHRpbWVzLnkgJiYgdGltZXMueSA8PSAxXG4gICAgICAgICAgICA/IHRoaXMubGluZXNbaV0udjEuYWRkKHRoaXMubGluZXNbaV0udjIuc3ViKHRoaXMubGluZXNbaV0udjEpLm11bCh0aW1lcy54KSlcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmludGVyc2VjdGlvblBvaW50c1tpbmRleF1baV0gPSAwIDw9IHRpbWVzLnggJiYgdGltZXMueCA8PSAxICYmIDAgPD0gdGltZXMueSAmJiB0aW1lcy55IDw9IDFcbiAgICAgICAgICAgID8gdGhpcy5saW5lc1tpXS52MS5hZGQodGhpcy5saW5lc1tpXS52Mi5zdWIodGhpcy5saW5lc1tpXS52MSkubXVsKHRpbWVzLngpKVxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucmVuZGVySW50ZXJzZWN0aW9ucygpO1xuICB9XG4gIHJlbmRlckludGVyc2VjdGlvbnMoKTogdm9pZCB7XG4gICAgdGhpcy5yZW5kZXJlci5jbGVhckludGVyc2VjdGlvbnMoKTtcbiAgICB0aGlzLmludGVyc2VjdGlvblBvaW50cy5mb3JFYWNoKGludGVyc2VjdGlvblBvaW50cyA9PiB7XG4gICAgICBpbnRlcnNlY3Rpb25Qb2ludHMuZm9yRWFjaChpbnRlcnNlY3Rpb25Qb2ludCA9PiB7XG4gICAgICAgIGlmIChpbnRlcnNlY3Rpb25Qb2ludCkge1xuICAgICAgICAgIHRoaXMucmVuZGVyZXIuZHJhd1BvaW50KGludGVyc2VjdGlvblBvaW50KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn0iLCJpbXBvcnQgeyBDbGlja0hhbmRsZXIsIFBvbHBsb3RSZW5kZXJlciB9IGZyb20gXCIuL2ludGVyZmFjZXMvcG9scGxvdC1yZW5kZXJlclwiO1xuaW1wb3J0IHsgTGluZSB9IGZyb20gXCIuL2xpbmVcIjtcbmltcG9ydCB7IFZlY3RvcjIgfSBmcm9tIFwiLi92ZWN0b3IyXCI7XG5cbmNvbnN0IGdUZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnZycpO1xuZ1RlbXBsYXRlLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2JsYWNrJyk7XG5nVGVtcGxhdGUuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMC40cHgnKTtcblxuY29uc3QgbGluZVRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG5saW5lVGVtcGxhdGUuc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaGFycmF5JywgJzEwLCA0LCAxLCA0Jyk7XG5cbmNvbnN0IGFuY2hvclRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XG5hbmNob3JUZW1wbGF0ZS5zZXRBdHRyaWJ1dGUoXG4gICdkJyxcbiAgJ00gMCwgMCcgK1xuICAnQSAxMCwgMTAsIDAsIDAsIDAsIC01LCAtNScgKyBcbiAgJ0EgMTAsIDEwLCAwLCAxLCAxLCA1LCAtNScgK1xuICAnQSAxMCwgMTAsIDAsIDAsIDAsIDAsIDAnXG4pO1xuYW5jaG9yVGVtcGxhdGUuc2V0QXR0cmlidXRlKCdmaWxsJywgJ3doaXRlJyk7XG5cbmdUZW1wbGF0ZS5hcHBlbmRDaGlsZChsaW5lVGVtcGxhdGUpO1xuZ1RlbXBsYXRlLmFwcGVuZENoaWxkKGFuY2hvclRlbXBsYXRlKTtcbmdUZW1wbGF0ZS5hcHBlbmRDaGlsZChhbmNob3JUZW1wbGF0ZS5jbG9uZU5vZGUoKSk7XG5cbmNvbnN0IHBvaW50VGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2NpcmNsZScpO1xucG9pbnRUZW1wbGF0ZS5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnZ3JlZW4nKTtcbnBvaW50VGVtcGxhdGUuc2V0QXR0cmlidXRlKCdyJywgJzMnKTtcblxuZXhwb3J0IGNsYXNzIFN2Z1JlbmRlcmVyIGltcGxlbWVudHMgUG9scGxvdFJlbmRlcmVyIHtcbiAgcmVhZG9ubHkgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgcHJpdmF0ZSBpbnRlcnNlY3Rpb25Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2cnKTtcbiAgcHJpdmF0ZSBzdmdHQnlMaW5lID0gbmV3IE1hcDxMaW5lLCBTVkdHRWxlbWVudD4oKTtcbiAgcHJpdmF0ZSBsaW5lQnlTdmdHID0gbmV3IE1hcDxTVkdHRWxlbWVudCwgTGluZT4oKTtcbiAgcHJpdmF0ZSBvbk1vdXNlRG93bjogKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiBhbnk7XG4gIHByaXZhdGUgb25Nb3VzZVVwOiAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IGFueTtcbiAgcHJpdmF0ZSBvbk1vdXNlTW92ZTogKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiBhbnk7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKHRoaXMuaW50ZXJzZWN0aW9uQ29udGFpbmVyKTtcbiAgfVxuICBjbGlja0hhbmRsZXJXcmFwcGVyKGNsaWNrSGFuZGxlcjogQ2xpY2tIYW5kbGVyKTogKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiBhbnkge1xuICAgIHJldHVybiBldmVudCA9PiB7XG4gICAgICBjb25zdCBlbGVtZW50QXQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkpO1xuICAgICAgY29uc3QgbGluZSA9IHRoaXMubGluZUJ5U3ZnRy5nZXQoZWxlbWVudEF0LnBhcmVudE5vZGUgYXMgU1ZHR0VsZW1lbnQpO1xuICAgICAgaWYgKGVsZW1lbnRBdCBpbnN0YW5jZW9mIFNWR1BhdGhFbGVtZW50KSB7XG4gICAgICAgIGlmIChlbGVtZW50QXQucGFyZW50Tm9kZS5jaGlsZHJlblsxXSA9PT0gZWxlbWVudEF0KSB7XG4gICAgICAgICAgY2xpY2tIYW5kbGVyKGV2ZW50LCBsaW5lLCBsaW5lLnYxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjbGlja0hhbmRsZXIoZXZlbnQsIGxpbmUsIGxpbmUudjIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnRBdCBpbnN0YW5jZW9mIFNWR0xpbmVFbGVtZW50KSB7XG4gICAgICAgIGNsaWNrSGFuZGxlcihldmVudCwgbGluZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjbGlja0hhbmRsZXIoZXZlbnQpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgc2V0TW91c2VEb3duSGFuZGxlcihjbGlja0hhbmRsZXI6IENsaWNrSGFuZGxlcik6IHZvaWQge1xuICAgIGlmICh0aGlzLm9uTW91c2VEb3duKSB7XG4gICAgICB0aGlzLnN2Zy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uTW91c2VEb3duKTtcbiAgICB9XG4gICAgdGhpcy5vbk1vdXNlRG93biA9IHRoaXMuY2xpY2tIYW5kbGVyV3JhcHBlcihjbGlja0hhbmRsZXIpO1xuICAgIHRoaXMuc3ZnLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25Nb3VzZURvd24pO1xuICB9XG4gIHNldE1vdXNlVXBIYW5kbGVyKGNsaWNrSGFuZGxlcjogQ2xpY2tIYW5kbGVyKTogdm9pZCB7XG4gICAgaWYgKHRoaXMub25Nb3VzZVVwKSB7XG4gICAgICB0aGlzLnN2Zy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbk1vdXNlVXApO1xuICAgIH1cbiAgICB0aGlzLm9uTW91c2VVcCA9IHRoaXMuY2xpY2tIYW5kbGVyV3JhcHBlcihjbGlja0hhbmRsZXIpO1xuICAgIHRoaXMuc3ZnLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm9uTW91c2VVcCk7XG4gIH1cbiAgc2V0TW91c2VNb3ZlSGFuZGxlcihjbGlja0hhbmRsZXI6IENsaWNrSGFuZGxlcik6IHZvaWQge1xuICAgIGlmICh0aGlzLm9uTW91c2VNb3ZlKSB7XG4gICAgICB0aGlzLnN2Zy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uTW91c2VNb3ZlKTtcbiAgICB9XG4gICAgdGhpcy5vbk1vdXNlTW92ZSA9IHRoaXMuY2xpY2tIYW5kbGVyV3JhcHBlcihjbGlja0hhbmRsZXIpO1xuICAgIHRoaXMuc3ZnLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMub25Nb3VzZU1vdmUpO1xuICB9XG4gIGRyYXdMaW5lKGxpbmU6IExpbmUsIGlzSG92ZXJlZCA9IGZhbHNlLCBpc1NlbGVjdGVkID0gZmFsc2UpOiB2b2lkIHtcbiAgICBsZXQgc3ZnRzogU1ZHR0VsZW1lbnQ7XG4gICAgaWYgKCF0aGlzLnN2Z0dCeUxpbmUuaGFzKGxpbmUpKSB7XG4gICAgICBzdmdHID0gZ1RlbXBsYXRlLmNsb25lTm9kZSh0cnVlKSBhcyBTVkdHRWxlbWVudDtcbiAgICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKHN2Z0cpO1xuICAgICAgdGhpcy5zdmdHQnlMaW5lLnNldChsaW5lLCBzdmdHKTtcbiAgICAgIHRoaXMubGluZUJ5U3ZnRy5zZXQoc3ZnRywgbGluZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN2Z0cgPSB0aGlzLnN2Z0dCeUxpbmUuZ2V0KGxpbmUpO1xuICAgIH1cbiAgICBjb25zdCBzdmdMaW5lID0gc3ZnRy5jaGlsZHJlblswXSBhcyBTVkdMaW5lRWxlbWVudDtcbiAgICBjb25zdCBzdmdQYXRoQW5jaG9yU3RhcnQgPSBzdmdHLmNoaWxkcmVuWzFdIGFzIFNWR1BhdGhFbGVtZW50O1xuICAgIGNvbnN0IHN2Z1BhdGhBbmNob3JFbmQgPSBzdmdHLmNoaWxkcmVuWzJdIGFzIFNWR1BhdGhFbGVtZW50O1xuICAgIGNvbnN0IHgxID0gbGluZS54MS50b0ZpeGVkKCk7XG4gICAgY29uc3QgeTEgPSBsaW5lLnkxLnRvRml4ZWQoKTtcbiAgICBjb25zdCB4MiA9IGxpbmUueDIudG9GaXhlZCgpO1xuICAgIGNvbnN0IHkyID0gbGluZS55Mi50b0ZpeGVkKCk7XG4gICAgc3ZnTGluZS5zZXRBdHRyaWJ1dGUoJ3gxJywgeDEpO1xuICAgIHN2Z0xpbmUuc2V0QXR0cmlidXRlKCd5MScsIHkxKTtcbiAgICBzdmdMaW5lLnNldEF0dHJpYnV0ZSgneDInLCB4Mik7XG4gICAgc3ZnTGluZS5zZXRBdHRyaWJ1dGUoJ3kyJywgeTIpO1xuICAgIGlmIChpc0hvdmVyZWQpIHtcbiAgICAgIHN2Z0cuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMC44cHgnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3ZnRy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcwLjRweCcpO1xuICAgIH1cbiAgICBpZiAoaXNTZWxlY3RlZCkge1xuICAgICAgc3ZnRy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjMTlhMTk0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN2Z0cuc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnYmxhY2snKTtcbiAgICB9XG4gICAgY29uc3QgYW5nbGUgPSAxODAgKiAobGluZS52Mi5zdWIobGluZS52MSkuYW5nbGUoKSAtIE1hdGguUEkgLyAyKSAvIE1hdGguUEk7XG4gICAgc3ZnUGF0aEFuY2hvclN0YXJ0LnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke3gxfSwgJHt5MX0pIHJvdGF0ZSgke2lzTmFOKGFuZ2xlKSA/IDAgOiBhbmdsZX0pYCk7XG4gICAgc3ZnUGF0aEFuY2hvckVuZC5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHt4Mn0sICR7eTJ9KSByb3RhdGUoJHtpc05hTihhbmdsZSkgPyAwIDogMTgwICsgYW5nbGV9KWApO1xuICB9XG4gIGVyYXNlTGluZShsaW5lOiBMaW5lKTogdm9pZCB7XG4gICAgY29uc3Qgc3ZnRyA9IHRoaXMuc3ZnR0J5TGluZS5nZXQobGluZSk7XG4gICAgaWYgKHN2Z0cpIHtcbiAgICAgIHRoaXMuc3ZnLnJlbW92ZUNoaWxkKHN2Z0cpO1xuICAgICAgdGhpcy5zdmdHQnlMaW5lLmRlbGV0ZShsaW5lKTtcbiAgICB9XG4gIH1cbiAgZHJhd1BvaW50KHBvaW50OiBWZWN0b3IyKTogdm9pZCB7XG4gICAgY29uc3Qgc3ZnQ2lyY2xlID0gcG9pbnRUZW1wbGF0ZS5jbG9uZU5vZGUoKSBhcyBTVkdDaXJjbGVFbGVtZW50O1xuICAgIHN2Z0NpcmNsZS5zZXRBdHRyaWJ1dGUoJ2N4JywgcG9pbnQueC50b0ZpeGVkKCkpO1xuICAgIHN2Z0NpcmNsZS5zZXRBdHRyaWJ1dGUoJ2N5JywgcG9pbnQueS50b0ZpeGVkKCkpO1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uQ29udGFpbmVyLmFwcGVuZENoaWxkKHN2Z0NpcmNsZSk7XG4gIH1cbiAgY2xlYXJJbnRlcnNlY3Rpb25zKCk6IHZvaWQge1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uQ29udGFpbmVyLmNoaWxkTm9kZXMuZm9yRWFjaChjaGlsZE5vZGUgPT4gdGhpcy5pbnRlcnNlY3Rpb25Db250YWluZXIucmVtb3ZlQ2hpbGQoY2hpbGROb2RlKSk7XG4gIH1cbn0iLCJpbXBvcnQgeyBQb2xQbG90IH0gZnJvbSBcIi4vcG9scGxvdFwiO1xuaW1wb3J0IHsgU3ZnUmVuZGVyZXIgfSBmcm9tIFwiLi9zdmctcmVuZGVyZXJcIjtcblxuY29uc3Qgc3ZnUmVuZGVyZXIgPSBuZXcgU3ZnUmVuZGVyZXIoKTtcbmNvbnN0IHBvbHBsb3QgPSBuZXcgUG9sUGxvdChzdmdSZW5kZXJlcik7XG5jb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xuYm9keS5hcHBlbmRDaGlsZChzdmdSZW5kZXJlci5zdmcpOyJdLCJzb3VyY2VSb290IjoiIn0=